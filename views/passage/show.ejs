<!DOCTYPE html>
<html lang="en">

<?include ../partials/head ?>

<body>



 <? include ../partials/header ?>



 <!-- Page Content -->
 <div class="container">

  <!-- Page Heading -->
  <div class="row">
    <div class="col-lg-12">
      <h1 class="page-header">
        <?= passage.title ?>
      </h1>

    </div>
  </div>
  <!-- /.row -->


  <div class="row">
    <div class="col-lg-12 text-left">
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="row ">

            <div  class="col-md-12">
              <?- passage.statement ?>
            </div>
          </div>

          <div class="row ">

            <div  class="col-md-2 small-font" >
              <div style="background-color: lightgray; padding:10px; ">
                <img src="https://unsplash.it/50/50/?random" class="img-rounded" alt="Cinque Terre" width="35" height="35">
                <?= passage.user.email ?> <br>
                <?=   moment(passage.updatedAt).format('MMM D, YYYY [at] h:mm:ss a');  ?><br>
              </div>

            </div>
            <div class="col-md-1">
              <div style="padding:10px;">
               <img src="/images/ladder.png" class="img-circle" alt="Cinque Terre" width="35" height="35">
             </div>

           </div>
         </div>

         <hr>

         <br>



         <? passage.comments.forEach(function(comment, index) { ?>
         <div class="row small-font" >
          <div class="col-lg-1 small-font">
            <img src="/images/ladder.png" class="img-circle" alt="Cinque Terre" width="20" height="20"> 
          </div>

          <div class="col-lg-11">
            <!-- style="white-space: pre-wrap;" -->
            <span ><?= comment.text ?></span> - <?= comment.user.email ?> <?=   moment(comment.updatedAt).format('MMM D, YYYY [at] h:mm:ss a');  ?> <a href=""> edit</a>

          </div>

        </div>

        <hr style="margin-top: 10px; margin-bottom: 10px;">
        <? }); ?>

        <a href="javascript:" style="font-size: 0.875em" onclick="$('#passage-comment').removeClass('hidden'); $(this).hide('slow')">write a comment</a> | <a href="javascript:" style="font-size: 0.875em" onclick="loadMoreComments('passage', '<?=passage._id?>')">load more </a>

        <form id="passage-comment" class="hidden" action="/passages/<?= passage.id ?>/comments" method="POST">
          <div class="form-group">
            <!-- <label>Add Comment</label> -->
            <textarea class="form-control" rows="3" name="text"></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Comment</button>
        </form>


      </div>
    </div>
  </div>
</div>
<!-- /.row -->




<div class="row">
  <div class="col-md-12 text-left">
    <div class="panel panel-default">
      <div class="panel-body">
        <h3><?= attempts.length? attempts.length + " Attempt" + (attempts.length > 1? "s": "") : "" ?></h3>
        <!-- <h3>Attempts</h3> -->
        <hr>
        <? attempts.forEach(function(attempt, index) { ?>
        <div class="row">
          <div class="col-lg-2 small-font">
           <img src="https://unsplash.it/50/50/?random" class="img-circle" alt="Cinque Terre" width="50" height="50"> <br>
           <?= attempt.user.email ?> <br>
           <?=   moment(attempt.updatedAt).format('MMM D, YYYY [at] h:mm:ss a');  ?>
         </div>

         <div class="col-lg-10">
          <?- attempt.translation ?>
        </div>



      </div>


      <div class="row">
        <div class="col-lg-2">
        </div>

        <div class="col-lg-10">

         <? attempt.comments.forEach(function(comment, index) { ?>
         <div class="row small-font" >
          <div class="col-lg-1 small-font">
            <img src="/images/ladder.png" class="img-circle" alt="Cinque Terre" width="20" height="20"> 
          </div>

          <div class="col-lg-11">
            <!-- style="white-space: pre-wrap;" -->
            <span ><?= comment.text ?></span> - <?= comment.user.email ?> <?=   moment(comment.updatedAt).format('MMM D, YYYY [at] h:mm:ss a');  ?> <a href=""> edit</a>

          </div>

        </div>

        <hr style="margin-top: 10px; margin-bottom: 10px;">
        <? }); ?>
        <a href="javascript:" style="font-size: 0.875em" onclick="$('#attempt-comment<?=attempt._id?>').removeClass('hidden'); $(this).hide('slow')">write a comment</a> | <a href="javascript:" style="font-size: 0.875em" onclick="loadMoreComments('attempt', '<?=attempt._id?>')">load more </a>

        <form id="attempt-comment<?=attempt._id?>" class="hidden" action="/attempts/<?= attempt.id ?>/comments" method="POST">
          <div class="form-group">
            <textarea class="form-control" rows="3" name="text"></textarea>
          </div>
          <button type="submit" class="btn btn-primary">Comment</button>
        </form>
      </div>


    </div>
    <hr>
    <? }); ?>
  </div>
</div>
</div>





<div class="row">


  <div class="col-lg-12">
    <!-- <h1>Attempt A Translation</h1> -->




    <!-- <h1>Attempt A Translation</h1> -->
    <form role="form" action="/passages/<?= passage.id ?>/attempts" method="POST">
      <div class="form-group">
        <label>Attempt Translation</label>
        <textarea class="form-control" rows="3" name="translation"></textarea>
      </div>
      <button type="submit" class="btn btn-primary">Attempt</button>
    </form>



  </div>
</div>
<!--   <div class="row" style="margin-top: 25px;">

    <div class="col-lg-12">

      <form action="/passages/<?= passage.id ?>/comments" method="POST">
        <div class="form-group">
          <label>Add Comment</label>
          <textarea class="form-control" rows="3" name="text"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Send</button>
      </form>

    </div>

    
  </div> -->
  <!-- /.row -->  

</div>
<!-- /.container -->

</div>
<!-- /#wrapper -->
<? include ../partials/footer ?>


<script>

function loadMoreComments(type, id) {
  console.log(type, id)
}

</script>

</body>

</html>


